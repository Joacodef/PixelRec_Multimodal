# Default configuration for multimodal recommender

model:
  # Model selection
  model_class: pretrained         # Options: 'pretrained' or 'enhanced'
  vision_model: clip              # Options: clip, resnet, dino, convnext
  language_model: sentence-bert   # Options: sentence-bert, mpnet, bert, roberta
  
  # Core parameters
  embedding_dim: 64
  freeze_vision: true
  freeze_language: true
  
  # Contrastive learning
  use_contrastive: true
  contrastive_temperature: 0.07
  
  # Regularization
  dropout_rate: 0.3
  
  # Attention mechanism
  num_attention_heads: 4
  attention_dropout: 0.1
  
  # Fusion network architecture
  fusion_hidden_dims: [512, 256, 128]  # List of hidden layer dimensions
  fusion_activation: relu  # Options: relu, gelu, tanh, leaky_relu, silu
  use_batch_norm: true
  
  # Projection layers
  projection_hidden_dim: null  # Set to integer to add hidden layer in projections
  
  # Cross-modal attention (for enhanced model)
  use_cross_modal_attention: true
  cross_modal_attention_weight: 0.5
  
  # Other architectural choices
  final_activation: sigmoid  # Options: sigmoid, tanh, none
  init_method: xavier_uniform  # Options: xavier_uniform, xavier_normal, kaiming_uniform, kaiming_normal

training:
  # Basic training parameters
  batch_size: 64
  epochs: 30
  learning_rate: 0.001
  weight_decay: 0.01
  patience: 10
  gradient_clip: 1.0
  num_workers: 8
  
  # Loss weights
  contrastive_weight: 0.1
  bce_weight: 1.0
  
  # Learning rate scheduling
  use_lr_scheduler: true
  lr_scheduler_type: reduce_on_plateau  # Options: reduce_on_plateau, cosine, step
  lr_scheduler_patience: 2
  lr_scheduler_factor: 0.5
  lr_scheduler_min_lr: 0.000001
  
  # Optimizer settings
  optimizer_type: adamw  # Options: adamw, adam, sgd
  adam_beta1: 0.9
  adam_beta2: 0.999
  adam_eps: 0.00000001

data:
  # Raw data paths (for preprocessing)
  item_info_path: data/raw/item_info/item_info_sample.csv
  interactions_path: data/raw/interactions/interactions_sample.csv
  image_folder: data/raw/images

  # Processed data paths (training, evaluation and recommendation)
  processed_item_info_path: data/processed/item_info.csv
  processed_interactions_path: data/processed/interactions.csv
  scaler_path: data/processed/numerical_scaler.pkl
  processed_image_destination_folder: data/processed/images

  # Split data paths
  split_data_path: data/splits/split_tiny
  train_data_path: data/splits/split_tiny/train.csv
  val_data_path: data/splits/split_tiny/val.csv
  test_data_path: data/splits/split_tiny/test.csv

  cache_processed_images: true
  image_cache_config:
    strategy: 'hybrid' # Options: 'hybrid', 'memory', 'disk', 'disabled'
    max_memory_items: 1500
    cache_directory: 'data/cache/image_tensors'
    precompute_at_startup: false
    preprocessing_batch_size: 50
  
  # Offline image compression settings
  offline_image_compression:
    enabled: true                   # Master switch for this compression step
    # Images larger than this (in KB) will be subject to compression/resizing.
    # Images smaller than this will be copied as-is to the processed_image_destination_folder.
    compress_if_kb_larger_than: 500 
    target_quality: 85              # For JPEG compression (0-100, higher is better)
    
    # Optional resizing: if an image's dimensions exceed these, it will be resized
    # before potential compression. Set to null or remove if no pre-resize is needed.
    resize_if_pixels_larger_than: [2048, 2048] # [width, height] 
    # If resizing, the longest edge of the image will be scaled to this value,
    # maintaining aspect ratio.
    resize_target_longest_edge: 1024 
  
  negative_sampling_ratio: 1.0
  
  # Numerical features
  numerical_features_cols:
    - view_number
    - comment_number
    - thumbup_number
    - share_number
    - coin_number
    - favorite_number
    - barrage_number
  
  numerical_normalization_method: standardization  # Options: log1p, standardization, min_max, none
  
  # Text augmentation
  text_augmentation:
    enabled: true
    augmentation_type: random_delete  # Options: random_delete, random_swap, none
    delete_prob: 0.05
    swap_prob: 0.05
  
  # Offline image validation
  offline_image_validation:
    check_corrupted: true
    min_width: 64
    min_height: 64
    allowed_extensions: ['.jpg', '.jpeg', '.png']
  
  # Offline text cleaning
  offline_text_cleaning:
    remove_html: true
    normalize_unicode: true
    to_lowercase: true
  

  # Data splitting configuration
  splitting:
    random_state: 42

    # These should sum to 1.0
    train_final_ratio: 0.40
    val_final_ratio: 0.15
    test_final_ratio: 0.45

    min_interactions_per_user: 5
    min_interactions_per_item: 5
    validate_no_leakage: true

recommendation:
  top_k: 50
  diversity_weight: 0.3
  novelty_weight: 0.2
  filter_seen: true
  max_candidates: 1000

# Paths
checkpoint_dir: models/checkpoints
results_dir: results